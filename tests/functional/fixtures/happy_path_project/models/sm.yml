semantic_models:
  - name: my_sm
    model: ref('outer')
    defaults:
      agg_time_dimension: created_at
    entities:
      - name: my_entity
        type: primary
        expr: id
      - name: user
        type: foreign
        expr: user_id
    dimensions:
      - name: created_at
        type: time
        type_params:
          time_granularity: day
    measures:
      - name: total_outer_count
        agg: count
        expr: 1
      - name: discrete_order_value_p99
        expr: order_total
        agg: percentile
        agg_time_dimension: created_at
        agg_params:
          percentile: 0.99
          use_discrete_percentile: True
          use_approximate_percentile: False
        create_metric: true
      - name: sum_of_things
        expr: 2
        agg: sum
        agg_time_dimension: created_at
      - name: has_revenue
        expr: true
        agg: sum_boolean
        agg_time_dimension: created_at
      - name: test_non_additive
        expr: txn_revenue
        agg: sum
        non_additive_dimension:
          name: created_at
          window_choice: max
